<div class="static-content">

  <div class="index-list">

    <ul>
      <li><a href="#page-suspend-feature">Suspend rendering feature</a></li>
      <li><a href="#page-suspend-api">API methods</a></li>
      <li><a href="#page-suspend-demo">Supsend - an example</a></li>
    </ul>
  </div>

  <div class="example-container head-gap clearfix" name="suspend-feature">
    <h3 id="page-suspend-feature">Suspending operations</h3>
    <p>Suspending (also called "batching") operations might be useful if you want to work on improving the performance.
      Batching several costly operations can decrease the number of reflows and render cycles for CRUD operations.
      It results in less layout trashing, fewer freezes, and a more responsive feel.
      <br>
      There are several <strong>API methods</strong> which allow suspending:
    </p>

    <ul>
      <li><code>suspendRender</code> and <code>resumeRender</code></li>
      <li><code>batchRender</code></li>
      <li><code>suspendExecution</code> and <code>resumeExecution</code></li>
      <li><code>batchExecution</code></li>
      <li><code>batch</code></li>
    </ul>

    <p>
    By using these methods you can suspend:
    <ul>
      <li>rendering</li>
      <li>execution</li>
      <li>both rendering and the execution.</li>
    </ul>

    <br>
      Term "rendering" refers directly to DOM rendering, the term
      "execution" refers to all operations that are different from DOM rendering.
      Currently only the indexes recalculation allows to postpone the process.
    </p>
    <p>
      Note that this is an advanced feature which can improve the performance but should be used with caution.
      Misuse can result in some flickering, glitches, or other visual distortion.
    </p>

  <div class="example-container head-gap clearfix" name="suspend-api">
    <h3 id="page-suspend-api">API methods</h3>
    <h4>Suspend rendering</h4>

    <p>
      <strong>suspendRender</strong> and <strong>resumeRender</strong>
      <br>
      To suspend the rendering process you can use <code>suspendRender</code> method just before the actions you want to batch.
      This is a manual approach - after suspending you have to remember to resume the process with the <code>resumeRender</code> method.
      <pre>
        <code class="lang-js">
hot.suspendRender(); // suspend rendering
hot.alter('insert_row', 5, 45);
hot.setDataAtCell(1, 1, 'x');
hot.resumeRender(); // remember to resume rendering
        </code>
      </pre>

      <p><strong>batchRender</strong> </p>
      The <code>batchRender</code> method is less prone to human errors since the operations will be calculated after executing the callback.
      You don't have to remember about resuming the operations.
      However, there is a drawback to this method: it doesn't support async operations.
      <pre>
        <code class="lang-js">
hot.batchRender(() => {
hot.alter('insert_row', 5, 45);
hot.setDataAtCell(1, 1, 'x');
// The table will be rendered once after executing the callback
});
        </code>
      </pre>
    </p>

    <h4>Suspend execution</h4>

    <p>
      <p><strong>suspendExecution</strong> and <strong>resumeExecution</strong></p>
      To suspend the rendering process you can use <code>suspendExecution</code> method just before the actions you want to batch.
      This is a manual approach - after suspending you have to remember to resume the process with the <code>resumeExecution</code> method.
      <pre>
        <code class="lang-js">
hot.suspendExecution();
const filters = hot.getPlugin('filters');

filters.addCondition(2, 'contains', ['3']);
filters.filter();
hot.getPlugin('columnSorting').sort({ column: 1, sortOrder: 'desc' });
hot.resumeExecution(); // It updates the cache internally
        </code>
      </pre>

      <p><strong>batchExecution</strong> </p>
      The <code>batchExecution</code> method is less prone to human errors since the operations will be calculated after executing the callback.
      You don't have to remember about resuming the operations.
      However, there is a drawback to this method: it doesn't support async operations.
      <pre>
        <code class="lang-js">
hot.batchExecution(() => {
  const filters = hot.getPlugin('filters');

  filters.addCondition(2, 'contains', ['3']);
  filters.filter();
  hot.getPlugin('columnSorting').sort({ column: 1, sortOrder: 'desc' });
  // The table cache will be recalculated once after executing the callback
});
        </code>
      </pre>
    </p>

    <h4>Batch render and execution</h4>

    <p>
      This method supsends both rendering and other operations.
      It is universal and especially useful if you want to batch multiple API calls within the application.
      <pre>
        <code class="lang-js">
hot.batch(() => {
  hot.alter('insert_row', 5, 45);
  hot.setDataAtCell(1, 1, 'x');

  const filters = hot.getPlugin('filters');

  filters.addCondition(2, 'contains', ['3']);
  filters.filter();
  hot.getPlugin('columnSorting').sort({ column: 1, sortOrder: 'desc' });
  // The table cache will be recalculated and table render will be called once after executing the callback
});
        </code>
      </pre>

    </p>

  <div class="example-container clearfix" name="suspend-demo">
    <h3 id="page-suspend-demo">Live demo of suspend feature</h3>
    <p>The following examples show how much the <code>batch</code> method can decrease the render time.
      Both of the examples share the same dataset and operations. The first one shows how much time lapsed
      when the <code>batch</code> method was used. You can run the second example to check how much it takes
      to render without the <code>batch</code> method.

    </p>
      <div data-jsfiddle="example1">
        <div id="example1" class="hot"></div>
        <p id="log1"></p>
      </div>

      <div class="codeLayout">
        <div class="buttons">
          <button class="jsFiddleLink" data-runfiddle="example1">
            <i class="fa fa-jsfiddle"></i>
            Edit
          </button>
          <button class="dump" name="dump" data-dump="#example1" data-instance="hot1"
                  title="Print current data source to console">
            <i class="fa fa-terminal"></i>
            Log to console
          </button>
        </div>
        <style data-jsfiddle="example1">
            .handsontable .green-bg {
              background-color: #2ECC40;
            }

            .handsontable .red-bg {
              background-color: #FF4136;
            }

            #log {
              font-weight: bold;
            }
        </style>
        <script data-jsfiddle="example1">
            let now = null;

            function startLog() {
              if (now === null) {
                now = Date.now();
              }
            }

            function printLog() {
              const elapsedTime = Date.now() - now;
              log.appendChild(document.createTextNode(`All operations took: ${elapsedTime}ms`));
              now = null;
            }

            var data1 = [
              [1, 'Gary Nash', 'Speckled trousers', 'S', 1, 'yes'],
              [2, 'Gloria Brown', '100% Stainless sweater', 'M', 2, 'no'],
              [3, 'Ronald Carver', 'Sunny T-shirt', 'S', 1, 'no'],
              [4, 'Samuel Watkins', 'Floppy socks', 'S', 3, 'no'],
              [5, 'Stephanie Huddart', 'Bushy-bush cap', 'XXL', 1, 'no'],
              [6, 'Madeline McGillivray', 'Long skirt', 'L', 1, 'no'],
              [7, 'Jai Moor', 'Happy dress', 'XS', 1, 'no'],
              [8, 'Ben Lower', 'Speckled trousers', 'M', 1, 'no'],
              [9, 'Ali Tunbridge', 'Speckled trousers', 'M', 2, 'no'],
              [10, 'Archie Galvin', 'Regular shades', 'uni', 10, 'no']
            ];

            var data2 = [
              [11, 'Gavin Elle', 'Floppy socks', 'XS', 3, 'yes'],
            ];

            var data3 = [
              [12, 'Gary Erre', 'Happy dress', 'M', 1, 'no'],
              [13, 'Anna Moon', 'Unicorn shades', 'uni', 200, 'no'],
              [14, 'Elise Eli', 'Regular shades', 'uni', 1, 'no']
            ];

            const hot = new Handsontable(document.getElementById('example1'), {
              data: data1,
              width: 700,
              height: 300,
              colHeaders: ['ID', 'Customer name', 'Product name', 'Size', 'qty', 'Return'],
            });

            function alterTable() {
            startLog();
            hot.batch(() => {
              hot.alter('insert_row', 10, 10);
              hot.alter('insert_col', 6, 1);
              hot.populateFromArray(10, 0, data2);
              hot.populateFromArray(11, 0, data3);
              hot.setCellMeta(2, 2, 'className', 'green-bg');
              hot.setCellMeta(4, 2, 'className', 'green-bg');
              hot.setCellMeta(5, 2, 'className', 'green-bg');
              hot.setCellMeta(6, 2, 'className', 'green-bg');
              hot.setCellMeta(8, 2, 'className', 'green-bg');
              hot.setCellMeta(9, 2, 'className', 'green-bg');
              hot.setCellMeta(10, 2, 'className', 'green-bg');
              hot.alter('remove_col', 6, 1);
              hot.setCellMeta(0, 5, 'className', 'red-bg');
              hot.setCellMeta(10, 5, 'className', 'red-bg');
            })
            printLog();
            }
            // alterTable();
          </script>
      </div>

      <p>No <code>batch</code> used. The results are very same but it takes longer.

      </p>
        <div data-jsfiddle="example2">
          <div id="example2" class="hot"></div>
          <p id="log2"></p>
        </div>

        <div class="codeLayout">
          <div class="buttons">
            <button class="jsFiddleLink" data-runfiddle="example2">
              <i class="fa fa-jsfiddle"></i>
              Edit
            </button>
            <button class="dump" name="dump" data-dump="#example2" data-instance="hot2"
                    title="Print current data source to console">
              <i class="fa fa-terminal"></i>
              Log to console
            </button>
          </div>
          <style data-jsfiddle="example2">
            .handsontable .green-bg {
              background-color: #2ECC40;
            }

            .handsontable .red-bg {
              background-color: #FF4136;
            }

            #log {
              font-weight: bold;
            }
          </style>
          <script data-jsfiddle="example2">
            let now = null;

            function startLog() {
              if (now === null) {
                now = Date.now();
              }
            }

            function printLog() {
              const elapsedTime = Date.now() - now;
              log.appendChild(document.createTextNode(`All operations took: ${elapsedTime}ms`));
              now = null;
            }

            var data1 = [
              [1, 'Gary Nash', 'Speckled trousers', 'S', 1, 'yes'],
              [2, 'Gloria Brown', '100% Stainless sweater', 'M', 2, 'no'],
              [3, 'Ronald Carver', 'Sunny T-shirt', 'S', 1, 'no'],
              [4, 'Samuel Watkins', 'Floppy socks', 'S', 3, 'no'],
              [5, 'Stephanie Huddart', 'Bushy-bush cap', 'XXL', 1, 'no'],
              [6, 'Madeline McGillivray', 'Long skirt', 'L', 1, 'no'],
              [7, 'Jai Moor', 'Happy dress', 'XS', 1, 'no'],
              [8, 'Ben Lower', 'Speckled trousers', 'M', 1, 'no'],
              [9, 'Ali Tunbridge', 'Speckled trousers', 'M', 2, 'no'],
              [10, 'Archie Galvin', 'Regular shades', 'uni', 10, 'no']
            ];

            var data2 = [
              [11, 'Gavin Elle', 'Floppy socks', 'XS', 3, 'yes'],
            ];

            var data3 = [
              [12, 'Gary Erre', 'Happy dress', 'M', 1, 'no'],
              [13, 'Anna Moon', 'Unicorn shades', 'uni', 200, 'no'],
              [14, 'Elise Eli', 'Regular shades', 'uni', 1, 'no']
            ];

            const hot = new Handsontable(document.getElementById('example2'), {
              data: data1,
              width: 700,
              height: 300,
              colHeaders: ['ID', 'Customer name', 'Product name', 'Size', 'qty', 'Return'],
            });

            function alterTable() {
              startLog();
              hot.alter('insert_row', 10, 10);
              hot.alter('insert_col', 6, 1);
              hot.populateFromArray(10, 0, data2);
              hot.populateFromArray(11, 0, data3);
              hot.setCellMeta(2, 2, 'className', 'green-bg');
              hot.setCellMeta(4, 2, 'className', 'green-bg');
              hot.setCellMeta(5, 2, 'className', 'green-bg');
              hot.setCellMeta(6, 2, 'className', 'green-bg');
              hot.setCellMeta(8, 2, 'className', 'green-bg');
              hot.setCellMeta(9, 2, 'className', 'green-bg');
              hot.setCellMeta(10, 2, 'className', 'green-bg');
              hot.alter('remove_col', 6, 1);
              hot.setCellMeta(0, 5, 'className', 'red-bg');
              hot.setCellMeta(10, 5, 'className', 'red-bg');
              printLog();
            }

            alterTable();
          </script>
        </div>
  </div>

  <p class="gap-top-xsmall">
    <a href="https://github.com/handsontable/docs/edit/<?js= version ?>/tutorials/cell-types.html" class="edit-doc" target="_blank">
      Edit this page
    </a>
  </p>
</div>
